!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@angular/core"),require("@angular/common"),require("@angular/forms"),require("rxjs/BehaviorSubject")):"function"==typeof define&&define.amd?define("table",["exports","@angular/core","@angular/common","@angular/forms","rxjs/BehaviorSubject"],e):e(t.table={},t.ng.core,t.ng.common,t.ng.forms,t.rxjs.BehaviorSubject)}(this,function(t,e,n,o,a){"use strict";var s=function(){function t(){}return t.prototype.getLabel=function(t){return t.hasOwnProperty("label")?t.label:t},t.prototype.getValue=function(t){return t.hasOwnProperty("value")?t.value:t},t.prototype.getClass=function(t){return t.hasOwnProperty("classList")?t.classList.join(" "):t},t.prototype.formatValue=function(t,e,n){var o=t[this.getValue(e)];return e.format?e.format(o,e,t,n):o},t.decorators=[{type:e.Injectable}],t}(),i=0,r=function(){function t(t){this.tableHelper=t,this.update=new e.EventEmitter,this.id=i++}return t.prototype.updateDisplay=function(t,e){t.target.checked?(this.columns[e].hidden=!1,this.enableChildren(this.columns[e])):(this.columns[e].hidden=!0,this.disableChildren(this.columns[e])),this.emitColumns()},t.prototype.enableChildren=function(e){var n=this;this.columns=this.columns.map(function(t){return t.parent&&t.disabled&&-1!==t.parent.indexOf(e.value)&&(t.disabled=!1,n.enableChildren(t)),t})},t.prototype.disableChildren=function(e){var n=this;this.columns=this.columns.map(function(t){return t.parent&&!t.disabled&&-1!==t.parent.indexOf(e.value)&&(t.disabled=!0,t.hidden=!0,n.disableChildren(t)),t})},t.prototype.move=function(e,t){var n=this,o=this.columns.findIndex(function(t){return n.tableHelper.getValue(t)===n.tableHelper.getValue(e)}),a=o+t;a<0||a>this.columns.length-1||(this.columns.splice(o,1),this.columns.splice(a,0,e),setTimeout(function(){n.currentTarget=a}),this.emitColumns())},t.prototype.emitColumns=function(){this.update.emit(this.columns)},t.decorators=[{type:e.Component,args:[{selector:"aui-column-selector",template:'<ul class="a-list a-list--lined aui-column-selector">\n\t<li *ngFor="let column of columns; let i = index; let isLast = last; let isFirst = first;" class="animated" [ngClass]="{show: i === currentTarget}">\n\t\t<div class="a-input__checkbox a-input__checkbox--small">\n\t\t\t<input type="checkbox" id="checkbox-{{ id }}-{{ i }}-{{ tableHelper.getValue(column) }}" name="checkbox-{{ tableHelper.getValue(column) }}" [checked]="!column.hidden" (change)="updateDisplay($event, i)" [disabled]="column.disabled">\n\t\t\t<label for="checkbox-{{ id }}-{{ i }}-{{ tableHelper.getValue(column) }}">{{ tableHelper.getLabel(column) }}</label>\n\t\t</div>\n\t\t<div class="select-actions">\n\t\t\t<button [disabled]="isFirst" class="a-button-transparent a-button--tiny has-icon" (click)="move(column, -1)">\n\t\t\t\t<span class="fa fa-angle-up"></span>\n\t\t\t</button>\n\t\t\t<button [disabled]="isLast" class="a-button-transparent a-button--tiny has-icon" (click)="move(column, 1)">\n\t\t\t\t<span class="fa fa-angle-down"></span>\n\t\t\t</button>\n\t\t</div>\n\t</li>\n<ul>\n'}]}],t.ctorParameters=function(){return[{type:s}]},t.propDecorators={columns:[{type:e.Input}],update:[{type:e.Output}]},t}(),l=function(){function t(t){this.tableHelper=t,this.rows=[],this.columns=[],this.loading=!1,this.responsive=!0,this.hasClickAction=!1,this.noDataMessage="No data available.",this.loadDataMessage="Loading data...",this.noColumnsMessage="No columns available.",this.orderBy=new e.EventEmitter,this.rowClicked=new e.EventEmitter}return t.prototype.sort=function(t,e){var n=this.tableHelper.getValue(t);this.activeSorting={key:n,order:e},this.orderBy.emit({key:n,order:e})},t.prototype.clickRow=function(t){this.hasClickAction&&this.rowClicked.emit(t)},t.decorators=[{type:e.Component,args:[{selector:"aui-table",template:'<div [ngClass]="{\'a-table__wrapper-responsive\': responsive}">\n\t<table class="a-table a-table--striped aui-table">\n\t\t<thead *ngIf="columns.length > 0">\n\t\t\t<tr>\n\t\t\t\t<th *ngFor="let column of columns" [ngClass]="tableHelper.getClass(column)">\n\t\t\t\t\t<ng-container *ngIf="column.headerComponent">\n\t\t\t\t\t\t<aui-table-header [label]="tableHelper.getLabel(column)" [value]="tableHelper.getValue(column)" [component]="column.headerComponent"></aui-table-header>\n\t\t\t\t\t</ng-container>\n\t\t\t\t\t<ng-container *ngIf="!column.headerComponent">\n\t\t\t\t\t\t<ng-container *ngIf="activeSorting">\n\t\t\t\t\t\t\t<button *ngIf="!column.disableSorting && tableHelper.getValue(column) !== activeSorting?.key" class="a-button a-button--tiny a-button--transparent has-icon-right" (click)="sort(column, \'asc\')">\n\t\t\t\t\t\t\t\t{{ tableHelper.getLabel(column) }} <span class="fa fa-sort"></span>\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t<button *ngIf="!column.disableSorting && tableHelper.getValue(column) === activeSorting?.key && activeSorting?.order === \'desc\'" class=" a-button a-button--tiny a-button--transparent has-icon-right" (click)="sort(column, \'asc\')">\n\t\t\t\t\t\t\t\t{{ tableHelper.getLabel(column) }} <span class="fa fa-sort-desc"></span>\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t<button *ngIf="!column.disableSorting && tableHelper.getValue(column) === activeSorting?.key && activeSorting?.order === \'asc\'" class=" a-button a-button--tiny a-button--transparent has-icon-right" (click)="sort(column, \'desc\')">\n\t\t\t\t\t\t\t\t{{ tableHelper.getLabel(column) }} <span class="fa fa-sort-asc"></span>\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t<ng-container *ngIf="column.disableSorting">\n\t\t\t\t\t\t\t\t{{ tableHelper.getLabel(column) }}\n\t\t\t\t\t\t\t</ng-container>\n\t\t\t\t\t\t</ng-container>\n\t\t\t\t\t\t<ng-container *ngIf="!activeSorting">\n\t\t\t\t\t\t\t{{ tableHelper.getLabel(column) }}\n\t\t\t\t\t\t</ng-container>\n\t\t\t\t\t</ng-container>\n\t\t\t\t</th>\n\t\t\t</tr>\n\t\t</thead>\n\t\t<tbody>\n\t\t\t<tr *ngIf="loading">\n\t\t\t\t<td [colSpan]="columns.length">\n\t\t\t\t\t<div class="table-loading">\n\t\t\t\t\t\t{{ loadDataMessage }} <span class="a-spinner"></span>\n\t\t\t\t\t</div>\n\t\t\t\t</td>\n\t\t\t</tr>\n\t\t\t<tr *ngIf="!loading && columns.length === 0">\n\t\t\t\t<td>{{ noColumnsMessage }}</td>\n\t\t\t</tr>\n\t\t\t<tr *ngIf="!loading && (!rows || rows.length === 0)">\n\t\t\t\t<td [colSpan]="columns.length">{{ noDataMessage }}</td>\n\t\t\t</tr>\n\t\t\t<ng-container *ngIf="!loading && columns.length > 0">\n\t\t\t\t<tr *ngFor="let row of rows; let rowIndex = index" (click)="clickRow(row)" [ngClass]="{\'a-table--clickable\': hasClickAction}">\n\t\t\t\t\t<td *ngFor="let column of columns" [ngClass]="tableHelper.getClass(column)">\n\t\t\t\t\t\t<aui-table-cell [value]="tableHelper.formatValue(row, column, rowIndex)" [component]="column.component"></aui-table-cell>\n\t\t\t\t\t</td>\n\t\t\t\t</tr>\n\t\t\t</ng-container>\n\t\t</tbody>\n\t</table>\n</div>\n',changeDetection:e.ChangeDetectionStrategy.OnPush}]}],t.ctorParameters=function(){return[{type:s}]},t.propDecorators={rows:[{type:e.Input}],columns:[{type:e.Input}],loading:[{type:e.Input}],responsive:[{type:e.Input}],hasClickAction:[{type:e.Input}],activeSorting:[{type:e.Input}],noDataMessage:[{type:e.Input}],loadDataMessage:[{type:e.Input}],noColumnsMessage:[{type:e.Input}],orderBy:[{type:e.Output}],rowClicked:[{type:e.Output}]},t}(),c=function(){function t(){this.filters=[],this.filter=new e.EventEmitter,this.open=!1,this.invisibleItems=!1}return t.prototype.ngDoCheck=function(){this.countInvisibleItems()},t.prototype.isInVisible=function(t,e){return t.bottom<e.top},t.prototype.countInvisibleItems=function(){for(var t=this.ref.nativeElement.getBoundingClientRect(),e=this.ref.nativeElement.childNodes,n=e.length-1;0<=n;n--){var o=e[n];if("AUI-TABLE-BAR-ITEM"===o.nodeName&&o.getBoundingClientRect){var a=o.getBoundingClientRect();if(this.isInVisible(t,a)){this.invisibleItems=!0;break}}0===n&&(this.invisibleItems=!1)}},t.prototype.toggle=function(){this.open=!this.open},t.decorators=[{type:e.Component,args:[{selector:"aui-table-bar",template:'<div class="aui-table-bar">\n\t<div class="filters" #ref [ngClass]="{open: open}">\n\t\t<ng-content select="[auiTableBarItem]"></ng-content>\n\t\t<div class="aui-table-bar-item" *ngIf="open">\n\t\t\t<button class="a-button a-button--transparent" (click)="toggle()">Show less...</button>\n\t\t</div>\n\t</div>\n\t<div class="show-more" *ngIf="!open && invisibleItems">\n\t\t<button class="a-button a-button--transparent" (click)="toggle()">Show more...</button>\n\t</div>\n\n\t<ng-content select="[auiTableBarSearch]"></ng-content>\n</div>\n'}]}],t.propDecorators={filters:[{type:e.Input}],testFilter:[{type:e.Input}],filter:[{type:e.Output}],ref:[{type:e.ViewChild,args:["ref"]}]},t}(),u=function(){function t(t,e,n){this.viewContainerRef=t,this.componentFactoryResolver=e,this.changeDetectionRef=n}return t.prototype.ngOnChanges=function(){this.component&&this.loadComponent()},t.prototype.hasComponent=function(){return!!this.component},t.prototype.loadComponent=function(){var t=this.componentFactoryResolver.resolveComponentFactory(this.component),e=this.viewContainerRef;e.clear(),e.createComponent(t).instance.data=this.value,this.changeDetectionRef.detectChanges()},t.decorators=[{type:e.Component,args:[{selector:"aui-table-cell",template:'<ng-template *ngIf="hasComponent()"></ng-template>\n<span *ngIf="!hasComponent()">{{ value }}</span>\n'}]}],t.ctorParameters=function(){return[{type:e.ViewContainerRef},{type:e.ComponentFactoryResolver},{type:e.ChangeDetectorRef}]},t.propDecorators={component:[{type:e.Input}],value:[{type:e.Input}]},t}(),p=function(){function t(t,e,n){this.viewContainerRef=t,this.componentFactoryResolver=e,this.changeDetectionRef=n}return t.prototype.ngOnChanges=function(){this.component&&this.loadComponent()},t.prototype.hasComponent=function(){return!!this.component},t.prototype.loadComponent=function(){var t=this.componentFactoryResolver.resolveComponentFactory(this.component),e=this.viewContainerRef;e.clear(),e.createComponent(t).instance.data=this.value,this.changeDetectionRef.detectChanges()},t.decorators=[{type:e.Component,args:[{selector:"aui-table-header",template:'<ng-template *ngIf="hasComponent()"></ng-template>\n<span *ngIf="!hasComponent()">{{ label }}</span>\n'}]}],t.ctorParameters=function(){return[{type:e.ViewContainerRef},{type:e.ComponentFactoryResolver},{type:e.ChangeDetectorRef}]},t.propDecorators={component:[{type:e.Input}],label:[{type:e.Input}],value:[{type:e.Input}]},t}(),h=[r,l,c,u,p],d=[function(){function t(){this.setClass=!0}return t.decorators=[{type:e.Directive,args:[{selector:"[auiTableBarItem]"}]}],t.propDecorators={setClass:[{type:e.HostBinding,args:["class.aui-table-bar-item"]}]},t}(),function(){function t(){this.setClass=!0}return t.decorators=[{type:e.Directive,args:[{selector:"[auiTableBarSearch]"}]}],t.propDecorators={setClass:[{type:e.HostBinding,args:["class.aui-table-bar-search"]}]},t}()],m=function(){function t(){}return t.decorators=[{type:e.NgModule,args:[{imports:[n.CommonModule,o.FormsModule],providers:[s],declarations:[h,d],exports:[h,d]}]}],t}(),g=function(){function t(){this.rawData=[],this.filters=[],this.filteredData=new a.BehaviorSubject([]),this.rows=new a.BehaviorSubject([]),this.columns=new a.BehaviorSubject([])}return t.prototype.setRawData=function(t){this.rawData=t,this.updateFilteredData(),this.setLastPage(),this.updateRows()},t.prototype.setRawColumns=function(t){this.rawColumns=t,this.updateColumns()},t.prototype.setFilters=function(t){this.filters=t,this.updateFilteredData(),this.setLastPage(),this.updateRows()},t.prototype.addFilter=function(t){this.filters.push(t),this.updateFilteredData(),this.setLastPage(),this.updateRows()},t.prototype.setPage=function(t){this.page=Number(t),this.updateRows()},t.prototype.setLimit=function(t){this.limit=Number(t),this.setLastPage(),this.lastPage&&this.page>this.lastPage&&(this.page=this.lastPage),this.updateRows()},t.prototype.setOrderBy=function(t){this.orderBy=t,this.updateFilteredData(),this.setLastPage(),this.updateRows()},t.prototype.getOffset=function(){return this.page*this.limit-this.limit},t.prototype.setLastPage=function(){var t=this.filteredData.getValue();this.lastPage=Math.ceil(t?t.length/this.limit:0)},t.prototype.updateRows=function(){var t=this.filteredData.getValue();this.orderBy&&(t=this.sortData(t,this.orderBy.key,this.orderBy.order)),t=this.selectData(t,this.limit,this.getOffset()),this.rows.next(t)},t.prototype.updateColumns=function(){var t=this.filterHiddenColumns(this.rawColumns);this.columns.next(t)},t.prototype.updateFilteredData=function(){this.filteredData.next(this.filterData(this.rawData,this.filters))},t.prototype.filterData=function(t,e){var n=t.slice();return e.forEach(function(t){n=t.parseData(n)}),n},t.prototype.sortData=function(t,n,o){if(void 0===o&&(o="asc"),t&&t.sort&&n){var e=t.slice();return e.sort(function(t,e){return t[n]<e[n]?"asc"===o?-1:1:t[n]>e[n]?"asc"===o?1:-1:0}),e}},t.prototype.selectData=function(t,e,n){return t&&0<=e&&0<=n?t.slice(n,n+e):t},t.prototype.filterHiddenColumns=function(t){return t.filter(function(t){return!t.hidden})},t}();t.TableModule=m,t.ColumnSelectorComponent=r,t.TableComponent=l,t.TableCellComponent=u,t.TableHeaderComponent=p,t.TableBarComponent=c,t.Table=g,t.TableHelperService=s,t.ɵa=h,t.ɵb=d,Object.defineProperty(t,"__esModule",{value:!0})});
//# sourceMappingURL=table.umd.min.js.map