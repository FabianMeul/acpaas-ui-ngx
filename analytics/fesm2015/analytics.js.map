{"version":3,"file":"analytics.js.map","sources":["ng://analytics/lib/analytics/services/ga.service.ts","ng://analytics/lib/analytics/analytics.conf.ts","ng://analytics/lib/analytics/services/gtm.service.ts","ng://analytics/lib/analytics/services/index.ts","ng://analytics/lib/analytics/directives/event.directive.ts","ng://analytics/lib/analytics/directives/index.ts","ng://analytics/lib/analytics/analytics.module.ts"],"sourcesContent":["import { Injectable, Inject } from '@angular/core';\nimport { Location } from '@angular/common';\nimport { Router, NavigationEnd, ActivatedRoute } from '@angular/router';\nimport { filter, map } from 'rxjs/operators';\n\nimport { WINDOW } from '@acpaas-ui/ngx-components/utils';\n\n@Injectable()\nexport class GAService {\n\n\tconstructor(\n\t\tlocation: Location,\n\t\tprivate router: Router,\n\t\tprivate activatedRoute: ActivatedRoute,\n\t\t@Inject(WINDOW) private windowService\n\t) {\n\t\tif (!this.windowService.ga) {\n\t\t\tthrow new Error('GA is not defined, is analytics included?');\n\t\t}\n\n\t\tthis.autoTriggerPageView(location, router);\n\t}\n\n\tpublic setDimension(key: string, value: string) {\n\t\tthis.windowService.ga('set', key, value);\n\t}\n\n\tpublic triggerPageView(title?: string, location?: string, page?: string) {\n\t\tthis.windowService.ga('send', 'pageview', {\n\t\t\ttitle: title || this.windowService.document.title,\n\t\t\tlocation: location || this.windowService.location.href,\n\t\t\tpage: page || this.windowService.location.pathname,\n\t\t});\n\t}\n\n\tpublic triggerEvent(category: string, action: string, label?: string, value?: any) {\n\t\tif (!category) {\n\t\t\tthrow new Error('category is required');\n\t\t}\n\n\t\tif (!action) {\n\t\t\tthrow new Error('action is required');\n\t\t}\n\n\t\tif (!label) {\n\t\t\treturn this.windowService.ga('send', 'event', category, action);\n\t\t}\n\n\t\tif (!value) {\n\t\t\treturn this.windowService.ga('send', 'event', category, action, label);\n\t\t}\n\n\t\treturn this.windowService.ga('send', 'event', category, action, label, value);\n\t}\n\n\tprivate autoTriggerPageView(location: Location, router: Router) {\n\t\trouter.events\n\t\t\t.pipe(\n\t\t\t\tfilter(event => event instanceof NavigationEnd),\n\t\t\t\tmap(() => this.findLastChild(this.activatedRoute))\n\t\t\t)\n\t\t\t.subscribe((route: any) => {\n\t\t\t\tif (!route.data || !route.data.doNotTrack) {\n\t\t\t\t\tthis.triggerPageView(this.windowService.document.title, this.windowService.location.href, location.path());\n\t\t\t\t}\n\t\t\t});\n\t}\n\n\tprivate findLastChild(activatedRoute: ActivatedRoute) {\n\t\tconst snapshot = activatedRoute.snapshot;\n\n\t\tlet child = snapshot.firstChild;\n\t\twhile (child.firstChild !== null) {\n\t\t\tchild = child.firstChild;\n\t\t}\n\n\t\treturn child;\n\t}\n}\n","import { InjectionToken } from '@angular/core';\nimport { GTMConfig } from './types/analytics.types';\n\nexport const GTM_CONFIG = new InjectionToken('GTM_CONFIG');\n\nexport const GTM_CONFIG_DEFAULT: GTMConfig = {\n\tPAGE_VIEW: {\n\t\tTRIGGER: 'virtualPageView',\n\t},\n\tEVENT: {\n\t\tTRIGGER: 'eventTrigger',\n\t\tCATEGORY: 'eventCategory',\n\t\tACTION: 'eventAction',\n\t\tLABEL: 'eventLabel',\n\t\tVALUE: 'eventValue',\n\t},\n};\n","import { Injectable, Inject } from '@angular/core';\n\nimport { WINDOW } from '@acpaas-ui/ngx-components/utils';\n\nimport { GTM_CONFIG } from '../analytics.conf';\nimport { GTMConfig } from '../types/analytics.types';\n\n@Injectable()\nexport class GTMService {\n\tconstructor(\n\t\t@Inject(WINDOW) private windowService,\n\t\t@Inject(GTM_CONFIG) private config: GTMConfig\n\t) {}\n\n\tpublic addToDataLayer(data) {\n\t\tthis.windowService.dataLayer.push(data);\n\t}\n\n\tpublic trigger(event: string, data = {}) {\n\t\tconst eventData = {\n\t\t\t...data,\n\t\t\t'event': event,\n\t\t};\n\t\tthis.addToDataLayer(eventData);\n\t}\n\n\tpublic triggerPageView(data = {}) {\n\t\tthis.trigger(this.config.PAGE_VIEW.TRIGGER, data);\n\t}\n\n\tpublic triggerEvent(category: string, action: string, label?: string, value?: number) {\n\t\tthis.trigger(this.config.EVENT.TRIGGER, {\n\t\t\t[this.config.EVENT.CATEGORY]: category,\n\t\t\t[this.config.EVENT.ACTION]: action,\n\t\t\t[this.config.EVENT.LABEL]: label,\n\t\t\t[this.config.EVENT.VALUE]: value,\n\t\t});\n\t}\n}\n","import { GAService } from './ga.service';\nimport { GTMService } from './gtm.service';\n\nexport const Services = [\n\tGAService,\n\tGTMService,\n];\n","import { Directive, ElementRef, Input, HostListener } from '@angular/core';\n\nimport { GAService } from '../services/ga.service';\n\n@Directive({ selector: '[auiGaEvent]' })\nexport class GaEventDirective {\n\t@Input() gaEvent: number;\n\n\tconstructor(private el: ElementRef, private gaService: GAService) {}\n\n\t@HostListener('click', ['$event'])\n\tonClick(e) {\n\t\tconst nativeEl = this.el.nativeElement;\n\n\t\tif (this.gaEvent) {\n\t\t\tthis.gaService.triggerEvent(nativeEl.tagName.toLowerCase(), 'click', nativeEl.innerText, this.gaEvent);\n\t\t} else {\n\t\t\tthis.gaService.triggerEvent(nativeEl.tagName.toLowerCase(), 'click', nativeEl.innerText);\n\t\t}\n\t}\n}\n","import { GaEventDirective } from './event.directive';\n\nexport const Directives = [\n\tGaEventDirective,\n];\n","import { NgModule, ModuleWithProviders } from '@angular/core';\n\nimport { WindowModule } from '@acpaas-ui/ngx-components/utils';\n\nimport { Services } from './services/index';\nimport { Directives } from './directives/index';\n\nimport { GTM_CONFIG, GTM_CONFIG_DEFAULT } from './analytics.conf';\n\n\n@NgModule({\n\timports: [\n\t\tWindowModule,\n\t],\n\tproviders: [\n\t\t{ provide: GTM_CONFIG, useValue: GTM_CONFIG_DEFAULT },\n\t\tServices,\n\t],\n\tdeclarations: [\n\t\tDirectives,\n\t],\n\texports: [\n\t\tDirectives,\n\t],\n})\nexport class AnalyticsModule {\n\tstatic forChild(config = {}): ModuleWithProviders {\n\t\tconfig = {\n\t\t\t...GTM_CONFIG_DEFAULT,\n\t\t\t...config,\n\t\t};\n\n\t\treturn {\n\t\t\tngModule: AnalyticsModule,\n\t\t\tproviders: [\n\t\t\t\t{ provide: GTM_CONFIG, useValue: config },\n\t\t\t\tServices,\n\t\t\t],\n\t\t};\n\t}\n}\n"],"names":[],"mappings":"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"}
